---
title: "R Notebook"
output: html_notebook
---

```{r}
openpres <- function(url){
return(as.character(substitute(url))) %>%
getURL() %>%
textConnection() %>%
read.csv()
}
```

```{r}
labelling <- function(argument){
str_c("https://openprescribing.net/api/1.0/", argument, "&format=csv")
}

labelling("spending/?format=api")
```

```{r}
drug_details <- function(Query){
str_c("https://openprescribing.net/api/1.0/bnf_code/?q=", Query, "&format=csv") %>%
getURL() %>%
textConnection() %>%
read.csv()
}

E.g
drug_details("lipid")
```

"Search for details about a CCG or practice by code or name. Returns values for all months available."

```{r, message=FALSE, warnings=FALSE}
library("devtools")
#devtools::install_github("klutometis/roxygen")
library(roxygen2)
#create("OpenPrescribing")
```

#Example URL segments from  [https://openprescribing.net/api/](https://openprescribing.net/api/)
spending/?format=api
spending/?code=0212
spending_by_ccg/?code=0212000AA
spending_by_ccg/?code=0212000AA&org=03V
spending_by_practice/?code=0212&date=2015-04-01
spending_by_practice/?code=0212000AA&date=2015-04-01
spending_by_practice/?code=0212000AAAAAAAA&date=2015-04-01
spending_by_practice/?code=0212000AA&org=H81068
spending_by_practice/?code=0212000AA&org=99P

bnf_code/?q=lipid
bnf_code/?q=0212000AA
bnf_code/?q=2.4
bnf_code/?q=0212000AA&exact=true
org_code/?q=Beaumont
org_code/?q=Gloucester&org_type=CCG
org_code/?q=Gloucester&org_type=practice
org_code/?exact=true&q=99H
org_details/?org_type=ccg&keys=total_list_size
org_details/?org_type=practice&org=99H&keys=total_list_size
org_details/?org_type=practice&org=99H&keys=astro_pu_items,astro_pu_cost

```{r Example Import Function}
openpres <- function(argument){
str_c("https://openprescribing.net/api/1.0/", argument, "&format=csv") %>%
getURL() %>%
textConnection() %>%
read.csv()
}
```
